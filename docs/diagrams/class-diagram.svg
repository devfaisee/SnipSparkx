<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="700" font-family="'Segoe UI', Arial, sans-serif">
  <style>
    .title { font-size: 24px; font-weight: 600; }
    .subtitle { font-size: 14px; fill: #475569; }
    .card rect { fill: #f8fafc; stroke: #1d4ed8; stroke-width: 2; rx: 10; }
    .card-title { font-size: 16px; font-weight: 600; fill: #0f172a; }
    .card-body { font-size: 13px; fill: #0f172a; }
    .section-label { font-size: 12px; fill: #64748b; letter-spacing: 0.1em; text-transform: uppercase; }
    .connector { stroke: #0f172a; stroke-width: 2; marker-end: url(#arrowhead); }
    .connector-label { font-size: 12px; fill: #0f172a; }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0f172a" />
    </marker>
  </defs>

  <text x="600" y="48" text-anchor="middle" class="title">SnipSparkx – Core Class Diagram</text>
  <text x="600" y="72" text-anchor="middle" class="subtitle">Mirrors actual classes in public/index.html, public/admin.html, and api/_lib</text>

  <text x="80" y="120" class="section-label">Frontend Classes</text>
  <g class="card" transform="translate(60,140)">
    <rect width="300" height="200" />
    <text x="150" y="28" text-anchor="middle" class="card-title">Snippet</text>
    <text class="card-body">
      <tspan x="80" y="60">• id, title, description, code, html</tspan>
      <tspan x="80" dy="20">• getSrcDoc()</tspan>
      <tspan x="80" dy="20">• renderCard(onPreview)</tspan>
      <tspan x="80" dy="20">• _esc(text)</tspan>
    </text>
  </g>

  <g class="card" transform="translate(450,140)">
    <rect width="320" height="220" />
    <text x="160" y="28" text-anchor="middle" class="card-title">SnippetManager</text>
    <text class="card-body">
      <tspan x="70" y="60">• init(), fetchSnippets(), renderSnippets()</tspan>
      <tspan x="70" dy="20">• openModal(snippet), closeModal()</tspan>
      <tspan x="70" dy="20">• _wireEvents()</tspan>
      <tspan x="70" dy="20">• Keeps refs: container, modal, tabs, search</tspan>
    </text>
  </g>

  <g class="card" transform="translate(830,140)">
    <rect width="300" height="220" />
    <text x="150" y="28" text-anchor="middle" class="card-title">AdminDashboard JS</text>
    <text class="card-body">
      <tspan x="70" y="60">• checkAuth(), fetchSnippets()</tspan>
      <tspan x="70" dy="20">• renderList(), loadSnippet()</tspan>
      <tspan x="70" dy="20">• resetForm(), setMsg()</tspan>
      <tspan x="70" dy="20">• Form submit/delete/preview handlers</tspan>
      <tspan x="70" dy="20">• Stores JWT tokenKey in localStorage</tspan>
    </text>
  </g>

  <text x="80" y="390" class="section-label">Backend Modules</text>
  <g class="card" transform="translate(120,410)">
    <rect width="320" height="220" />
    <text x="160" y="28" text-anchor="middle" class="card-title">SnippetStore</text>
    <text class="card-body">
      <tspan x="70" y="60">• add(), update(), delete()</tspan>
      <tspan x="70" dy="20">• read(), write(), _save()</tspan>
      <tspan x="70" dy="20">• _commitToGitHub()</tspan>
      <tspan x="70" dy="20">• static cleanHtml()</tspan>
      <tspan x="70" dy="20">• Fields: filePath, githubToken, repo</tspan>
    </text>
  </g>

  <g class="card" transform="translate(500,410)">
    <rect width="210" height="160" />
    <text x="105" y="28" text-anchor="middle" class="card-title">AuthHelper</text>
    <text class="card-body">
      <tspan x="40" y="60">• verify(req)</tspan>
      <tspan x="40" dy="20">• Uses JWT_SECRET + ADMIN_USER</tspan>
      <tspan x="40" dy="20">• Parses Authorization header</tspan>
    </text>
  </g>

  <g class="card" transform="translate(780,410)">
    <rect width="300" height="200" />
    <text x="150" y="28" text-anchor="middle" class="card-title">Serverless API Routes</text>
    <text class="card-body">
      <tspan x="60" y="60">• addSnippet.js → SnippetStore.add()</tspan>
      <tspan x="60" dy="20">• updateSnippet.js → SnippetStore.update()</tspan>
      <tspan x="60" dy="20">• deleteSnippet.js → SnippetStore.delete()</tspan>
      <tspan x="60" dy="20">• Each requires AuthHelper verification</tspan>
    </text>
  </g>

  <!-- Connectors -->
  <line class="connector" x1="360" y1="230" x2="450" y2="230" />
  <text x="405" y="216" class="connector-label">creates cards</text>

  <line class="connector" x1="770" y1="230" x2="830" y2="230" />
  <text x="800" y="216" class="connector-label">admin UI calls modal</text>

  <line class="connector" x1="430" y1="370" x2="430" y2="410" />
  <text x="444" y="392" class="connector-label" transform="rotate(-90 444 392)">renders snippets from store</text>

  <line class="connector" x1="640" y1="520" x2="780" y2="520" />
  <text x="710" y="506" class="connector-label">verified requests</text>

  <line class="connector" x1="280" y1="520" x2="500" y2="520" />
  <text x="390" y="506" class="connector-label">CRUD operations</text>

  <line class="connector" x1="930" y1="520" x2="780" y2="520" marker-end="url(#arrowhead)" />
  <text x="930" y="506" class="connector-label">API handlers</text>

  <line class="connector" x1="980" y1="250" x2="980" y2="410" />
  <text x="996" y="330" class="connector-label" transform="rotate(90 996 330)">dashboard uses APIs</text>
</svg>
